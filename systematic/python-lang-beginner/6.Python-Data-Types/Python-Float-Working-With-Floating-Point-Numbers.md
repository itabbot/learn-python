# Python 浮点数：使用浮点数<!-- omit in toc -->

- [1. 什么是 Python 浮点数？](#1-什么是-python-浮点数)
- [2. 创建浮点数](#2-创建浮点数)
- [3. 使用 Python 浮点数](#3-使用-python-浮点数)
- [4. Python 浮点数的精度有限](#4-python-浮点数的精度有限)

## 1. 什么是 Python 浮点数？

Python float 是一种数值数据类型，表示浮点数。浮点数是带有小数点或指数表示法的数字，表示数字在小数点或指数前后有一定位数。例如，数字 1.23 是小数点前有一位数字、小数点后有两位数字的浮点数。

## 2. 创建浮点数

在 Python 中有多种方法可以创建浮点数。大多数情况下，您只需按原样输入数字即可：

```py
f = 1.45
```

但是您可能希望使用 float() 函数将数字或字符串转换为浮点数：

```py
>>> float(2.0)
2.0
>>> float(2)
2.0
>>> float("2")
2.0
```

您还可以使用科学计数法：

```py
>>> f = 1.45e3
>>> f
1450.0
```

## 3. 使用 Python 浮点数

使用浮点数与使用整数没有太大区别。你可以进行通常的加、减、乘、除运算。

```py
>>> x = 1.45
>>> y = 4.51

>>> x + y
5.96
>>> x - y
-3.0599999999999996
>>> x * y
6.539499999999999
>>> x / y
0.3215077605321508
```

对于浮点数，我们经常需要对数字进行四舍五入。为此，Python 提供了 `round` 函数。`round` 函数接受两个参数：数字本身和可选精度（小数位数）。最后一个数字的默认值为 0，这意味着它将四舍五入为整数。以下是一些示例：

```py
>>> f = 1.4567
>>> round(f)
1
>>> round(f, 2)
1.46
>>> f = 1.54
>>> round(f)
2
>>> round(f, 1)
1.5
```

`floor` 函数将浮点数向下舍入为最接近的整数，而 `ceil` 函数将浮点数向上舍入为最接近的整数。以下是如何导入和使用这些函数的示例：

```py
>>> from math import floor, ceil
>>> floor(1.23)
1
>>> ceil(1.23)
2
```

## 4. Python 浮点数的精度有限

有些小数是无穷无尽的。例如，当你用 1 除以 3 时，你可以将结果四舍五入为 0.33、0.3333333333 或 0.333333333333333333。无论你选择什么精度，总会有更多 3。由于存储浮点数的位数有限，因此许多数字都是尽力而为的近似值。因此浮点数的精度有限，因为它们存储在有限的内存中，有时在对浮点数执行算术运算时会导致意外结果：

```py
>>> 0.3 + 0.1
0.4
>>> 0.1 + 3.8
3.9
>>> 0.1 + 0.2
0.30000000000000004
```

在使用浮点数时不可能完全消除精度有限的问题。但是，在 Python 中使用浮点数时，有几种方法可以减轻精度有限的影响：

-   使用 decimal 模块： Python 标准库中的模块 decimal 提供对十进制浮点运算的支持。这允许您使用具有固定精度的十进制数，这对于需要比常规浮点数更精确的计算的应用程序非常有用。缺点是浮点数比使用十进制包要快得多。
-   使用 NumPy： numpy 模块是 Python 的一个流行科学计算库，支持处理数字数组。numpy 模块提供了一种名为 numpy.float128 的数据类型，允许您使用比常规浮点数精度更高的浮点数。
-   对浮点数进行四舍五入： 如前所述，您可以使用该 round 函数将浮点数四舍五入到指定的小数位数。限制计算中使用的小数位数有助于减少有限精度带来的奇怪影响，但这种方法会使您的计算更加不精确。
