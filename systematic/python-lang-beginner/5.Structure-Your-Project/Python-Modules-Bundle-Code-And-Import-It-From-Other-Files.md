# Python 模块：打包代码并从其他文件导入<!-- omit in toc -->

- [1. 什么是模块？](#1-什么是模块)
- [2. Python 导入](#2-python-导入)
  - [2.1. 创建并导入模块](#21-创建并导入模块)
  - [2.2. 导入模块的特定部分](#22-导入模块的特定部分)
  - [2.3. 通配符导入（不好的做法）](#23-通配符导入不好的做法)
  - [2.4. 导入别名](#24-导入别名)
- [3. 有效的 Python 模块名称](#3-有效的-python-模块名称)
- [4. 如何创建可运行的 Python 模块](#4-如何创建可运行的-python-模块)
- [5. 类与模块](#5-类与模块)

## 1. 什么是模块？

如果您创建一个 Python 文件来执行某些任务，则将其称为脚本。如果您创建一个 Python 文件来存储函数、类和其他定义，则将其称为模块。我们通过使用 `import` 语句从模块中导入来使用模块。

因此，模块是一个包含以 .py 结尾的 Python 代码的文件。换句话说：任何 Python 文件也是模块。模块的名称与文件名相同，但不包括扩展名。例如，如果您创建一个名为 的文件 mymodule.py，则模块的名称为 mymodule。

## 2. Python 导入

可以使用 Python 的 `import` 关键字导入 Python 模块。我们通常将模块导入放在脚本的顶部，但这不是必须的。例如，有时您想动态决定是否需要导入模块，尤其是当该模块占用大量内存或其他资源时。

### 2.1. 创建并导入模块

创建一个名为 mymodule.py 的简单模块：

```py
# mymodule.py

def my_function():
    print('Hello world!')
```

在另一个脚本中导入此模块，但必须确保两个文件位于同一目录中：

```py
# test.py

# 这将导入整个模块，并以名称 mymodule 的形式供程序的其余部分使用
import mymodule

# 使用 import 导入模块后，可以使用以下命令使用该函数
mymodule.my_function()
```

### 2.2. 导入模块的特定部分

我们还可以导入模块的特定部分，例如函数、变量或类：

```py
# 该函数以名称 my_function 的形式供程序的其余部分使用
from mymodule import my_function

# 可以这样使用，就像它是在文件本身内部定义的一样
my_function()
```

类似地，我们可以从 Python 模块导入多个元素。类似这样：

```py
from mymodule import my_function, my_variable
```

### 2.3. 通配符导入（不好的做法）

当模块包含许多要导入的函数和其他元素时，您可能想使用特殊语法一次性导入它们。要从模块导入所有内容，我们可以使用以下语法：

```py
from mymodule import *
```

在大多数情况下，您应该避免使用该语法，因为它可能会导致意外结果，尤其是在使用您无法控制的第三方模块时。毕竟，您不知道第三方模块中有什么，也不知道将来会有什么。通过导入所有内容，您会用不必要的变量、类和函数“污染”您的命名空间。您甚至可能会在不知情的情况下覆盖一些现有的定义。我的建议是：只导入特定元素以控制您的命名空间。

### 2.4. 导入别名

有时 Python 模块名称可能不是你喜欢的样子。在这种情况下，你可以使用别名来缩短模块名称。例如，如果你有一个名为 mymodule.py 的模块，你可以将其导入为 m：

```py
import mymodule as m
```

## 3. 有效的 Python 模块名称

Python 模块的名称有一些限制。因为我们必须能够从 Python 代码中导入它们，并使用常规变量使用/引用它们，因此，有效的 Python 模块名称与常规变量名称有很多共同之处：

基本规则：

-   是一串字母、数字
-   如果有助于提高可读性，可以包含下划线
-   不能以数字开头
-   不包含空格或其他空白字符
-   不能包含以下任何附加字符：\ / : \* ? ” < > | –

除了这些规则之外，命名模块时还需要遵循一些最佳实践。值得注意的是：

-   模块名称请使用小写字母。
-   确保名称简短且具有描述性。

常见错误：

-   一个常见的错误是使用保留字或现有模块名称作为模块名称。我自己也犯过这样的错误，例如创建了一个名为 http 的模块，而 Python 已经有一个同名的模块。
-   难以调试的错误的另一个常见原因是将模块命名与目录相同。

## 4. 如何创建可运行的 Python 模块

在模块内部，您可以检测它是用作模块还是脚本。这很有用，因为它允许您单独运行模块，也可以同时从其他代码导入它。

当我们导入一个模块时，它的名称存储在变量 `__name__` 中。当执行脚本时， `__name__` 始终被设置为字符串 `__main__`。因此，如果我们检查此名称，我们就会知道我们是作为脚本运行，还是作为模块包含在某处。

比如下方示例，如果直接运行它，脚本调用了 greeter 函数，可以看到屏幕上打印了内容。但是当导入此模块时，脚本不会调用 greeter 函数：

```py
# mymodule.py

def greeter():
    print('Hello from mymodule.py')

if __name__ == '__main__':
    greeter()
```

## 5. 类与模块

您可能想知道模块与类相比如何，毕竟，它们都是功能的组合。不过，它们之间存在显著差异，Python 同时拥有模块和类是有充分理由的。

模块将相似的功能或相关的功能集中到一个位置。例如，模块可能包含我们用于连接特定类型数据库的类、函数和常量。

类可以为您的问题领域建模。它为一个或多个对象提供蓝图。例如，学生类包含学生数据和处理该数据的相关函数。可以有许多学生，因此可以同时有许多学生对象。
